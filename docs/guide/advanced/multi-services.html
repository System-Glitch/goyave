<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Multi-services | Goyave</title>
    <meta name="description" content="An Elegant Golang Web Framework">
    <link rel="icon" type="image/png" sizes="16x16" href="/goyave/goyave_16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/goyave/goyave_32.png">
  <link rel="icon" type="image/png" sizes="64x64" href="/goyave/goyave_64.png">
  <link rel="icon" type="image/png" sizes="128x128" href="/goyave/goyave_128.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/goyave/goyave_256.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/goyave/goyave_512.png">
  <meta property="twitter:title" content="Goyave">
  <meta property="twitter:description" content="An Elegant Golang Web Framework">
  <meta property="twitter:image:src" content="https://system-glitch.github.io/goyave/goyave_banner.png">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="og:title" content="Goyave">
  <meta property="og:type" content="website">
  <meta property="og:description" content="An Elegant Golang Web Framework">
  <meta property="og:image" content="https://system-glitch.github.io/goyave/goyave_banner.png">
  <meta property="og:site_name" content="Goyave">
    
    <link rel="preload" href="/goyave/assets/css/0.styles.79261d3a.css" as="style"><link rel="preload" href="/goyave/assets/js/app.58da958a.js" as="script"><link rel="preload" href="/goyave/assets/js/2.e98777cd.js" as="script"><link rel="preload" href="/goyave/assets/js/12.44bc0695.js" as="script"><link rel="preload" href="/goyave/assets/js/3.a964193e.js" as="script"><link rel="prefetch" href="/goyave/assets/js/10.6a9d4641.js"><link rel="prefetch" href="/goyave/assets/js/11.f3b013f5.js"><link rel="prefetch" href="/goyave/assets/js/13.4786515c.js"><link rel="prefetch" href="/goyave/assets/js/14.3764a769.js"><link rel="prefetch" href="/goyave/assets/js/15.0ac76f37.js"><link rel="prefetch" href="/goyave/assets/js/16.66f5cb96.js"><link rel="prefetch" href="/goyave/assets/js/17.6e41d592.js"><link rel="prefetch" href="/goyave/assets/js/18.2de1d1bf.js"><link rel="prefetch" href="/goyave/assets/js/19.d72d67f2.js"><link rel="prefetch" href="/goyave/assets/js/20.ecf0beaa.js"><link rel="prefetch" href="/goyave/assets/js/21.d7b17f63.js"><link rel="prefetch" href="/goyave/assets/js/22.b838cf84.js"><link rel="prefetch" href="/goyave/assets/js/23.8fef9985.js"><link rel="prefetch" href="/goyave/assets/js/24.61ce605e.js"><link rel="prefetch" href="/goyave/assets/js/25.a1ffdd10.js"><link rel="prefetch" href="/goyave/assets/js/26.48dcf7db.js"><link rel="prefetch" href="/goyave/assets/js/27.07a8a51a.js"><link rel="prefetch" href="/goyave/assets/js/28.06b7938d.js"><link rel="prefetch" href="/goyave/assets/js/29.512827f7.js"><link rel="prefetch" href="/goyave/assets/js/4.cda9b5d2.js"><link rel="prefetch" href="/goyave/assets/js/5.8cff6807.js"><link rel="prefetch" href="/goyave/assets/js/6.ad56580a.js"><link rel="prefetch" href="/goyave/assets/js/7.89b74898.js"><link rel="prefetch" href="/goyave/assets/js/8.2e8722f8.js"><link rel="prefetch" href="/goyave/assets/js/9.da1fe802.js">
    <link rel="stylesheet" href="/goyave/assets/css/0.styles.79261d3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/goyave/" class="home-link router-link-active"><img src="/goyave/goyave_64.png" alt="Goyave" class="logo"> <span class="site-name can-hide">Goyave</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/goyave/guide/" class="nav-link router-link-active">Guide</a></div> <a href="https://github.com/System-Glitch/goyave" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/goyave/guide/" class="nav-link router-link-active">Guide</a></div> <a href="https://github.com/System-Glitch/goyave" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Basics</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Advanced</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/goyave/guide/advanced/helpers.html" class="sidebar-link">Helpers</a></li><li><a href="/goyave/guide/advanced/authentication.html" class="sidebar-link">Authentication</a></li><li><a href="/goyave/guide/advanced/localization.html" class="sidebar-link">Localization</a></li><li><a href="/goyave/guide/advanced/testing.html" class="sidebar-link">Testing</a></li><li><a href="/goyave/guide/advanced/multi-services.html" class="active sidebar-link">Multi-services</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goyave/guide/advanced/multi-services.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/advanced/multi-services.html#startup-hooks" class="sidebar-link">Startup hooks</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/advanced/multi-services.html#start-the-server" class="sidebar-link">Start the server</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/advanced/multi-services.html#stop-the-server" class="sidebar-link">Stop the server</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/advanced/multi-services.html#server-status" class="sidebar-link">Server status</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/advanced/multi-services.html#maintenance-mode" class="sidebar-link">Maintenance mode</a></li></ul></li><li><a href="/goyave/guide/advanced/cors.html" class="sidebar-link">CORS</a></li><li><a href="/goyave/guide/advanced/status-handlers.html" class="sidebar-link">Status Handlers</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="multi-services"><a href="#multi-services" class="header-anchor">#</a> Multi-services</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#startup-hooks">Startup hooks</a></li><li><a href="#start-the-server">Start the server</a></li><li><a href="#stop-the-server">Stop the server</a></li><li><a href="#server-status">Server status</a></li><li><a href="#maintenance-mode">Maintenance mode</a></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Sometimes you need to run several services in the same executable. For example if you are hosting a websocket server on top of your web API. Goyave can be run in a goroutine and stopped on-demand.</p> <p>All functions below are features that require the <code>goyave</code> package to be imported.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token string">&quot;github.com/System-Glitch/goyave/v2&quot;</span>
</code></pre></div><h2 id="startup-hooks"><a href="#startup-hooks" class="header-anchor">#</a> Startup hooks</h2> <p>Startup hooks are function executed in a goroutine after the server finished initializing. This is especially useful when you want to start other services or execute specific commands while being sure the server is up and running, ready to respond to incoming requests. Startup hooks must be registered <strong>before</strong> the <code>goyave.Start()</code> call.</p> <h4 id="goyave-registerstartuphook"><a href="#goyave-registerstartuphook" class="header-anchor">#</a> goyave.RegisterStartupHook</h4> <p>Register a startup hook to execute some code once the server is ready and running.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td><code>hook func()</code></td> <td><code>void</code></td></tr></tbody></table> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>goyave<span class="token punctuation">.</span><span class="token function">RegsiterStartupHook</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Server ready.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="goyave-clearstartuphooks"><a href="#goyave-clearstartuphooks" class="header-anchor">#</a> goyave.ClearStartupHooks</h4> <p>Clear all registered startup hooks. Useful when you are writing tests or developing a service able to restart your server multiple times.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td></td> <td><code>void</code></td></tr></tbody></table> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>goyave<span class="token punctuation">.</span><span class="token function">ClearStartupHooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="start-the-server"><a href="#start-the-server" class="header-anchor">#</a> Start the server</h2> <h4 id="goyave-start"><a href="#goyave-start" class="header-anchor">#</a> goyave.Start</h4> <p>Starts the server. This functions needs a route registrer function as a parameter. Learn more in the <a href="/goyave/guide/basics/routing.html">routing</a> section.<br>
The configuration is not reloaded if you call <code>Start</code> multiple times. You can still reload the configuration with <code>config.Load()</code> if you need it.
This operation is <strong>blocking</strong>. Triggers a panic if the server is already running.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td><code>routeRegistrer func(*goyave.Router)</code></td> <td><code>void</code></td></tr></tbody></table> <p><strong>Examples:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>goyave<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>routes<span class="token punctuation">.</span>Register<span class="token punctuation">)</span>
</code></pre></div><p><strong>Running the server in the background:</strong></p> <p>You can start the server in a goroutine. However, if you do this and the main goroutine terminates, the server will not shutdown gracefully and the program will exit right away. Be sure to call <code>goyave.Stop()</code> to stop the server gracefully before exiting. Learn more in the next section.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">go</span> goyave<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>routes<span class="token punctuation">.</span>Register<span class="token punctuation">)</span>
<span class="token comment">//...</span>
goyave<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="stop-the-server"><a href="#stop-the-server" class="header-anchor">#</a> Stop the server</h2> <p>When the running process receives a <code>SIGINT</code> or a <code>SIGTERM</code> signal, for example when you press <code>CTRL+C</code> to interrupt the program, the server will shutdown gracefully, so you don't have to handle that yourself.</p> <p>However, if you start the server in a goroutine, you have the responsability to shutdown properly. If you exit the program manually or if the main goroutine terminates, ensure that <code>goyave.Stop()</code> is called. If the program exits because of an interruption signal, the server will shutdown gracefully.</p> <h4 id="goyave-stop"><a href="#goyave-stop" class="header-anchor">#</a> goyave.Stop</h4> <p>Stop the server gracefully without interrupting any active connections. Make sure the program doesn't exit and waits instead for Stop to return.</p> <p>Stop does not attempt to close nor wait for hijacked connections such as WebSockets. The caller of <code>Stop</code> should separately notify such long-lived connections of shutdown and wait for them to close, if desired.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td></td> <td><code>void</code></td></tr></tbody></table> <p><strong>Examples:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>goyave<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="server-status"><a href="#server-status" class="header-anchor">#</a> Server status</h2> <p>The <code>goyave.IsReady()</code> function lets you know if the server is running or not.</p> <p>This function should not be used to wait for the server to be ready. Use a startup hook instead.</p> <h4 id="goyave-isready"><a href="#goyave-isready" class="header-anchor">#</a> goyave.IsReady</h4> <p>Returns true if the server is ready to receive and serve incoming requests.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td></td> <td><code>bool</code></td></tr></tbody></table> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">if</span> goyave<span class="token punctuation">.</span><span class="token function">IsReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Server is ready&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="maintenance-mode"><a href="#maintenance-mode" class="header-anchor">#</a> Maintenance mode</h2> <p><span class="badge tip" style="vertical-align:top;" data-v-c13ee5b0>Since v2.1.0</span></p> <p>On top of being able to start the server in maintenance mode using the <code>maintenance</code> configuration entry, you can enable and disable this mode at runtime.</p> <div class="table"><p><a href="#goyave-enablemaintenance">EnableMaintenance</a> <a href="#goyave-disablemaintenance">DisableMaintenance</a> <a href="#goyave-ismaintenanceenabled">IsMaintenanceEnabled</a></p></div><h4 id="goyave-enablemaintenance"><a href="#goyave-enablemaintenance" class="header-anchor">#</a> goyave.EnableMaintenance</h4> <p>Replace the main server handler with the &quot;Service Unavailable&quot; handler.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td></td> <td><code>void</code></td></tr></tbody></table> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>goyave<span class="token punctuation">.</span><span class="token function">EnableMaintenance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="goyave-disablemaintenance"><a href="#goyave-disablemaintenance" class="header-anchor">#</a> goyave.DisableMaintenance</h4> <p>Replace the main server handler with the original router.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td></td> <td><code>void</code></td></tr></tbody></table> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>goyave<span class="token punctuation">.</span><span class="token function">DisableMaintenance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="goyave-ismaintenanceenabled"><a href="#goyave-ismaintenanceenabled" class="header-anchor">#</a> goyave.IsMaintenanceEnabled</h4> <p>Returns true if the server is currently in maintenance mode.</p> <table><thead><tr><th>Parameters</th> <th>Return</th></tr></thead> <tbody><tr><td></td> <td><code>bool</code></td></tr></tbody></table> <p><strong>Example:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>goyave<span class="token punctuation">.</span><span class="token function">IsMaintenanceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/System-Glitch/goyave/edit/master/docs_src/src/guide/advanced/multi-services.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/goyave/guide/advanced/testing.html" class="prev">Testing</a></span> <span class="next"><a href="/goyave/guide/advanced/cors.html">CORS</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/goyave/assets/js/app.58da958a.js" defer></script><script src="/goyave/assets/js/2.e98777cd.js" defer></script><script src="/goyave/assets/js/12.44bc0695.js" defer></script><script src="/goyave/assets/js/3.a964193e.js" defer></script>
  </body>
</html>
