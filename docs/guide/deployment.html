<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deployment | Goyave</title>
    <meta name="description" content="An Elegant Golang Web Framework">
    <link rel="icon" type="image/png" sizes="16x16" href="/goyave/goyave_16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/goyave/goyave_32.png">
  <link rel="icon" type="image/png" sizes="64x64" href="/goyave/goyave_64.png">
  <link rel="icon" type="image/png" sizes="128x128" href="/goyave/goyave_128.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/goyave/goyave_256.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/goyave/goyave_512.png">
  <meta property="twitter:title" content="Goyave">
  <meta property="twitter:description" content="An Elegant Golang Web Framework">
  <meta property="twitter:image:src" content="https://system-glitch.github.io/goyave/goyave_banner.png">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="og:title" content="Goyave">
  <meta property="og:type" content="website">
  <meta property="og:description" content="An Elegant Golang Web Framework">
  <meta property="og:image" content="https://system-glitch.github.io/goyave/goyave_banner.png">
  <meta property="og:site_name" content="Goyave">
    
    <link rel="preload" href="/goyave/assets/css/0.styles.79261d3a.css" as="style"><link rel="preload" href="/goyave/assets/js/app.58da958a.js" as="script"><link rel="preload" href="/goyave/assets/js/2.e98777cd.js" as="script"><link rel="preload" href="/goyave/assets/js/26.48dcf7db.js" as="script"><link rel="prefetch" href="/goyave/assets/js/10.6a9d4641.js"><link rel="prefetch" href="/goyave/assets/js/11.f3b013f5.js"><link rel="prefetch" href="/goyave/assets/js/12.44bc0695.js"><link rel="prefetch" href="/goyave/assets/js/13.4786515c.js"><link rel="prefetch" href="/goyave/assets/js/14.3764a769.js"><link rel="prefetch" href="/goyave/assets/js/15.0ac76f37.js"><link rel="prefetch" href="/goyave/assets/js/16.66f5cb96.js"><link rel="prefetch" href="/goyave/assets/js/17.6e41d592.js"><link rel="prefetch" href="/goyave/assets/js/18.2de1d1bf.js"><link rel="prefetch" href="/goyave/assets/js/19.d72d67f2.js"><link rel="prefetch" href="/goyave/assets/js/20.ecf0beaa.js"><link rel="prefetch" href="/goyave/assets/js/21.d7b17f63.js"><link rel="prefetch" href="/goyave/assets/js/22.b838cf84.js"><link rel="prefetch" href="/goyave/assets/js/23.8fef9985.js"><link rel="prefetch" href="/goyave/assets/js/24.61ce605e.js"><link rel="prefetch" href="/goyave/assets/js/25.a1ffdd10.js"><link rel="prefetch" href="/goyave/assets/js/27.07a8a51a.js"><link rel="prefetch" href="/goyave/assets/js/28.06b7938d.js"><link rel="prefetch" href="/goyave/assets/js/29.512827f7.js"><link rel="prefetch" href="/goyave/assets/js/3.a964193e.js"><link rel="prefetch" href="/goyave/assets/js/4.cda9b5d2.js"><link rel="prefetch" href="/goyave/assets/js/5.8cff6807.js"><link rel="prefetch" href="/goyave/assets/js/6.ad56580a.js"><link rel="prefetch" href="/goyave/assets/js/7.89b74898.js"><link rel="prefetch" href="/goyave/assets/js/8.2e8722f8.js"><link rel="prefetch" href="/goyave/assets/js/9.da1fe802.js">
    <link rel="stylesheet" href="/goyave/assets/css/0.styles.79261d3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/goyave/" class="home-link router-link-active"><img src="/goyave/goyave_64.png" alt="Goyave" class="logo"> <span class="site-name can-hide">Goyave</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/goyave/guide/" class="nav-link router-link-active">Guide</a></div> <a href="https://github.com/System-Glitch/goyave" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/goyave/guide/" class="nav-link router-link-active">Guide</a></div> <a href="https://github.com/System-Glitch/goyave" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/goyave/guide/" class="sidebar-link">Introduction</a></li><li><a href="/goyave/guide/changelog.html" class="sidebar-link">Changelog</a></li><li><a href="/goyave/guide/installation.html" class="sidebar-link">Installation</a></li><li><a href="/goyave/guide/upgrade-guide.html" class="sidebar-link">Upgrade Guide</a></li><li><a href="/goyave/guide/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/goyave/guide/architecture-concepts.html" class="sidebar-link">Architecture Concepts</a></li><li><a href="/goyave/guide/deployment.html" class="active sidebar-link">Deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goyave/guide/deployment.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/deployment.html#application-configuration" class="sidebar-link">Application configuration</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/deployment.html#build" class="sidebar-link">Build</a></li><li class="sidebar-sub-header"><a href="/goyave/guide/deployment.html#deamon" class="sidebar-link">Deamon</a></li></ul></li><li><a href="/goyave/guide/contribution-guide.html" class="sidebar-link">Contributing to Goyave</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>The Basics</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Advanced</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="deployment"><a href="#deployment" class="header-anchor">#</a> Deployment</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#application-configuration">Application configuration</a></li><li><a href="#build">Build</a></li><li><a href="#deamon">Deamon</a><ul><li><a href="#systemd">Systemd</a></li></ul></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>There are some important details to think about before deploying your Goyave application to production. We are going to cover them in this section of the guide, and make sure your applications are deployed properly.</p> <h2 id="application-configuration"><a href="#application-configuration" class="header-anchor">#</a> Application configuration</h2> <p>Be sure to deploy your application with a <code>config.production.json</code> config file containing the correct values for your production environment and <strong>set the <code>GOYAVE_ENV</code> environment variable to <code>production</code>.</strong></p> <ol><li>Ensure that the <code>environment</code> entry is <code>production</code>.</li> <li>The <code>host</code> entry should be <code>0.0.0.0</code> if you want let open access to your service. If you're using Apache or Nginx as a proxy on the same machine, keep it at <code>127.0.0.1</code> so the server will only be accessible through the proxy.</li> <li>Change the <code>domain</code> entry to your domain name, if you use one.</li> <li>The <code>port</code> and <code>httpsPort</code> will very likely require a change. Most of the time, you need <code>80</code> and <code>443</code> respectively.</li> <li>If you use <code>https</code>, be sure to provide the paths to your <code>tlsCert</code> and <code>tlsKey</code>. Learn more <a href="/goyave/guide/configuration.html#setting-up-https">here</a>.</li> <li><code>debug</code> <strong>must</strong> be set do <code>false</code>. You don't want anyone to get important information about your internal errors and therefore your code when an error occurs.</li> <li>Change your database connection credentials. <code>dbAutoMigrate</code> should be set to <code>false</code>.</li></ol> <h2 id="build"><a href="#build" class="header-anchor">#</a> Build</h2> <p>Of course, don't run your application with <code>go run</code> in production. Build your application using <code>go build</code> and deploy the executable, alongside the config files and resources directory.</p> <p>The framework requires its default language and config files, so you need to ensure that the library's directory is present in your production environment.</p> <p>The following Dockerfile is an example of a goyave application called <code>docker-goyave</code>:</p> <div class="language-Dockerfile extra-class"><pre class="language-text"><code>FROM golang:alpine as builder

WORKDIR /app

COPY . .

RUN go build

FROM alpine:3.9

WORKDIR /app

COPY --from=builder /go/pkg/mod/github.com/!system-!glitch/goyave/ /go/pkg/mod/github.com/!system-!glitch/goyave/
COPY --from=builder /app/docker-goyave ./docker-goyave
COPY resources /app/resources
COPY config.production.json ./config.production.json

EXPOSE 80
ENV GOYAVE_ENV=production

ENTRYPOINT [ &quot;./docker-goyave&quot; ]
</code></pre></div><h2 id="deamon"><a href="#deamon" class="header-anchor">#</a> Deamon</h2> <p>Goyave applications are standalone and don't require any web server (such as Apache or Nginx) to function. However, this also means that you will need some additional installation steps on your production server.</p> <p>When running a web service, it is important that it stays online. Creating a <strong>deamon</strong> is necessary so your server can run in the background, have the correct filesystem permissions, and restart automatically after a crash or a reboot.</p> <p>You can achieve this with any supervisor program, but in this guide, we will use systemd as it's the most common one.</p> <h3 id="systemd"><a href="#systemd" class="header-anchor">#</a> Systemd</h3> <p>First, we need to create a user and its group for our application:</p> <div class="language- extra-class"><pre class="language-text"><code>sudo addgroup goyave
sudo useradd -r -s /bin/false goyave
sudo usermod -a -G goyave goyave
</code></pre></div><p>You may use the following systemd unit file to deploy your Goyave application:</p> <p><code>/etc/systemd/system/my-goyave-application.service</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>[Unit]
Description=Goyave application deamon

# If you are using a database, mysql for example, make sure the application
# service starts AFTER the database service.
# After=mysqld.service
After=network.target
StartLimitIntervalSec=0

[Service]
Environment=GOYAVE_ENV=production
WorkingDirectory=/path/to/goyave-application
ExecStart=/path/to/goyave-application/executable

# Process management
####################

Type=simple

# Can be changed to &quot;on-failure&quot;
Restart=always
RestartSec=1
TimeoutStopSec=600

# Run as goyave:goyave
User=goyave
Group=goyave

# Hardening measures
####################

# Provide a private /tmp and /var/tmp.
PrivateTmp=true

# Mount /usr, /boot/ and /etc read-only for the process.
ProtectSystem=full

# Deny access to /home, /root and /run/user
ProtectHome=true

# Disallow the process and all of its children to gain
# new privileges through execve().
NoNewPrivileges=true

# Use a new /dev namespace only populated with API pseudo devices
# such as /dev/null, /dev/zero and /dev/random.
PrivateDevices=true

# Deny the creation of writable and executable memory mappings.
MemoryDenyWriteExecute=true

[Install]
WantedBy=multi-user.target
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Replace <code>my-goyave-application</code> with the name of your application and <code>/path/to/goyave-application</code> with the <strong>absolute</strong> path to your application. This is important to have unique application names in case you run multiple goyave applications on the same server. You should also create a separate user and group for each application.</p></div> <p>Now let's run the service and enable it on system startup:</p> <div class="language- extra-class"><pre class="language-text"><code>sudo systemctl start my-goyave-application
sudo systemctl enable my-goyave-application
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/System-Glitch/goyave/edit/master/docs_src/src/guide/deployment.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/goyave/guide/architecture-concepts.html" class="prev">Architecture Concepts</a></span> <span class="next"><a href="/goyave/guide/contribution-guide.html">Contributing to Goyave</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/goyave/assets/js/app.58da958a.js" defer></script><script src="/goyave/assets/js/2.e98777cd.js" defer></script><script src="/goyave/assets/js/26.48dcf7db.js" defer></script>
  </body>
</html>
